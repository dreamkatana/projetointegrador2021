{"files":[{"id":"6a572253-6327-4c97-b7c7-cf5a393ca59c","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Sao_Paulo\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_ACCESSING\",\n    \"access\": \"DOMAIN\"\n  }\n}"},{"id":"4b6e5285-77f6-46b5-a0e0-7126ac05a802","name":"CÃ³digo","type":"server_js","source":"function doGet(e) {\n  regAcesso(); // Registra Acessos\n  return HtmlService.createTemplateFromFile(\"home\").evaluate();\n}\n\nfunction include(filename) {\n  return HtmlService.createHtmlOutputFromFile(filename)\n      .getContent();\n}\n\n//function include(filename) {\n//  return HtmlService.createHtmlOutputFromFile(filename)\n//      .setSandboxMode(HtmlService.SandboxMode.IFRAME)\n//      .getContent();\n//}\n\nfunction userSair() {\n  //var in_time \u003d Utilities.formatDate(new Date(), \"IST\", \"HH:mm:ss\");\n  //return HtmlService.createHtmlOutput(\"\u003ch1\u003eTeste - \"+in_time+\"\u003c/h1\u003e\").evaluate();\n  return HtmlService.createHtmlOutput(\n    \"\u003cscript\u003ewindow.top.location.href\u003d\u0027http://www.google.com\u0027;\u003c/script\u003e\"\n  );\n}\n\n\nfunction regAcesso() {\n  var dataAtual \u003d new Date();\n  var email \u003d Session.getActiveUser().getEmail();\n  var url \u003d \"https://docs.google.com/spreadsheets/d/1IMMaybEkHYUTDqc6q8S71gzyd-TgDEAzY_FFng_GT2E/edit#gid\u003d0\";\n  var ss \u003d SpreadsheetApp.openByUrl(url);\n  var ws \u003d ss.getSheetByName(\"acessos\");\n\n  ws.appendRow([email, dataAtual]);\n}\n\nfunction getTableData() {\n  var dataAtual \u003d new Date();\n  var email \u003d Session.getActiveUser().getEmail();\n  var url \u003d \"https://docs.google.com/spreadsheets/d/1IMMaybEkHYUTDqc6q8S71gzyd-TgDEAzY_FFng_GT2E/edit#gid\u003d0\";\n  var ss \u003d SpreadsheetApp.openByUrl(url);\n  var ws \u003d ss.getSheetByName(\"dados\");\n  var data \u003d ws.getRange(3,2, ws.getLastRow()-1,5).getDisplayValues();\n  var filtered \u003d data.filter(function (row) {\n    var d \u003d new Date( row[2] ); // change text to Date object\n    //Logger.log(d.getFullYear());    \n    return row[0] \u003d\u003d\u003d email; // then compare\n    //return row[1];\n  });\n\n  //Logger.log(filtered);\n  //Logger.log(JSON.stringify(filtered));\n  return filtered;\n}\n\n\n"},{"id":"50780d63-8ff9-4b63-add3-f1412e199908","name":"home","type":"html","source":"\u003c!doctype html\u003e\n\u003chtml lang\u003d\"pt-br\"\u003e\n\u003chead\u003e\n  \u003cmeta charset\u003d\"utf-8\"\u003e\n  \u003cmeta name\u003d\"viewport\" content\u003d\"width\u003ddevice-width, initial-scale\u003d1\"\u003e\n  \u003ctitle\u003eSINCWEB - Sistema de Notas de Alunos Ceprocamp\u003c/title\u003e\n  \u003clink rel\u003d\"shortcut icon\" href\u003d\"https://material.io/favicon.ico\"\u003e\n  \u003clink rel\u003d\"stylesheet\" href\u003d\"https://fonts.googleapis.com/css?family\u003dRoboto:300,400,500,700\"\u003e\n  \u003c!-- Bootstrap CSS --\u003e\n  \u003clink rel\u003d\"stylesheet\" href\u003d\"https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css\" integrity\u003d\"sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn\" crossorigin\u003d\"anonymous\"\u003e\n\n\u003c/head\u003e\n\u003cbody class\u003d\"home\"\u003e\n  \u003cnav class\u003d\"navbar navbar-expand-lg navbar-light\" style\u003d\"background-color: #f9ae90;\"\u003e\n  \u003ca class\u003d\"navbar-brand\" href\u003d\"#\"\u003e\n    \u003cimg src\u003d\"https://cdn.glitch.me/12ebb1ab-fe89-4e1b-9093-48adb287677e%2Funnamed%20(1).png?v\u003d1634591573571\" width\u003d\"60\" height\u003d\"60\" class\u003d\"d-inline-block align-top\" alt\u003d\"\"\u003e\n  \u003c/a\u003e\n  \u003cform class\u003d\"form-inline\"\u003e\n    \u003cbutton class\u003d\"btn btn-dark active\" type\u003d\"button\"\u003eNOTAS\u003c/button\u003e\n    \u003cbutton class\u003d\"btn btn-sm btn-outline-secondary\" type\u003d\"button\"\u003eQUADRO DE AVISOS\u003c/button\u003e\n  \u003c/form\u003e\n\n\u003c/nav\u003e\n\u003cbr\u003e\u003cbr\u003e\u003cbr\u003e\n  \u003cdiv class\u003d\"container\"\u003e\n          \u003cdiv class\u003d\"container\"\u003e\n        \u003cdiv class\u003d\"row\"\u003e\n          \u003cdiv class\u003d\"col s12\"\u003e\n            \u003ctable class\u003d\"table table-striped\"\u003e\n              \u003cthead\u003e\n                \u003ctr\u003e\n                    \u003cth\u003eDisciplinas\u003c/th\u003e\n                    \u003cth\u003eNotas\u003c/th\u003e\n                    \u003cth\u003eFaltas\u003c/th\u003e\n                \u003c/tr\u003e\n              \u003c/thead\u003e\n\n              \u003ctbody id\u003d\"table-body\"\u003e\n\n              \u003c/tbody\u003e\n            \u003c/table\u003e\n          \u003c/div\u003e\n        \u003c/div\u003e \u003c!--CLOSE ROW --\u003e\n      \u003c/div\u003e \u003c!-- CLOSE CONTAINER --\u003e\n  \u003c/div\u003e\n\n  \u003c?!\u003d include(\"table-js\"); ?\u003e\n   \u003c!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) --\u003e\n  \u003cscript src\u003d\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js\" integrity\u003d\"sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj\" crossorigin\u003d\"anonymous\"\u003e\u003c/script\u003e\n  \u003cscript src\u003d\"https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js\" integrity\u003d\"sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF\" crossorigin\u003d\"anonymous\"\u003e\u003c/script\u003e\n\n\u003c/body\u003e\n\u003c/html\u003e\n"},{"id":"28ba4dea-a326-4196-b068-fa887b2f42e8","name":"JavaScript","type":"html","source":"\u003c!-- myscript.js.html --\u003e\n\u003cscript\u003e\n    alert(\"Script included!\");\n\u003c/script\u003e"},{"id":"03187178-5b97-42a6-bd8b-c81bc3756da3","name":"Stylesheet","type":"html","source":"\u003cstyle\u003e\nbody {\n  background-color: coral;\n}\n\u003c/style\u003e"},{"id":"43e8eb36-6da5-4ccf-8ebe-337fbdcaf616","name":"table-js","type":"html","source":"\u003cscript\u003e\n\n\n  document.addEventListener(\"DOMContentLoaded\", function(){\n    //var dadosx \u003d google.script.run.getTableData();\n    //console.log(\"dados: \" + dadosx);\n    google.script.run.withSuccessHandler(gerarTabela).getTableData();\n  });\n\n  function gerarTabela(dataArray){\n\n  \n    var tbody \u003d document.getElementById(\"table-body\");\n\n    dataArray.forEach(function(r){\n\n    \n    var row \u003d document.createElement(\"tr\");\n    var col1 \u003d document.createElement(\"td\");\n    col1.textContent \u003d r[1];\n    var col2 \u003d document.createElement(\"td\");\n    col2.textContent \u003d r[3];\n    var col3 \u003d document.createElement(\"td\");\n    col3.textContent \u003d r[4];\n    row.appendChild(col1);\n    row.appendChild(col2);\n    row.appendChild(col3);\n    tbody.appendChild(row);\n    \n    });\n  };\n\n\n\n\u003c/script\u003e"},{"id":"09af4b9c-b02a-4d86-a874-5b5cd840ebdd","name":"table","type":"html","source":"  \u003c!DOCTYPE html\u003e\n  \u003chtml\u003e\n    \u003chead\u003e\n      \u003cbase target\u003d\"_top\"\u003e\n      \u003cmeta name\u003d\"viewport\" content\u003d\"width\u003ddevice-width, initial-scale\u003d1.0\" /\u003e\n      \u003c!--Import Google Icon Font--\u003e\n      \u003clink href\u003d\"https://fonts.googleapis.com/icon?family\u003dMaterial+Icons\" rel\u003d\"stylesheet\"\u003e\n      \u003c!--Import materialize.css--\u003e\n      \u003clink type\u003d\"text/css\" rel\u003d\"stylesheet\" href\u003d\"https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css\"  media\u003d\"screen,projection\"/\u003e\n\n      \u003c!--Let browser know website is optimized for mobile--\u003e\n      \u003cmeta name\u003d\"viewport\" content\u003d\"width\u003ddevice-width, initial-scale\u003d1.0\"/\u003e\n    \u003c/head\u003e\n    \u003cbody\u003e\n\n      \u003cdiv class\u003d\"container\"\u003e\n        \u003cdiv class\u003d\"row\"\u003e\n          \u003cdiv class\u003d\"col s12\"\u003e\n            \u003ctable class\u003d\"striped highlight\"\u003e\n              \u003cthead\u003e\n                \u003ctr\u003e\n                    \u003cth\u003eDisciplinas\u003c/th\u003e\n                    \u003cth\u003eNotas\u003c/th\u003e\n                    \u003cth\u003eFaltas\u003c/th\u003e\n                \u003c/tr\u003e\n              \u003c/thead\u003e\n\n              \u003ctbody id\u003d\"table-body\"\u003e\n\n              \u003c/tbody\u003e\n            \u003c/table\u003e\n          \u003c/div\u003e\n        \u003c/div\u003e \u003c!--CLOSE ROW --\u003e\n      \u003c/div\u003e \u003c!-- CLOSE CONTAINER --\u003e\n\n      \u003c!--JavaScript at end of body for optimized loading--\u003e\n      \u003cscript type\u003d\"text/javascript\" src\u003d\"https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js\"\u003e\u003c/script\u003e\n      \u003c?!\u003d include(\"table-js\"); ?\u003e\n    \u003c/body\u003e\n  \u003c/html\u003e\n        \n"}]}